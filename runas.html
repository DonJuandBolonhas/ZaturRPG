<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Forjador de Runas</title>
<style>
body {
  background:#1e1b16;
  color:#e8dcc2;
  font-family: 'Georgia', serif;
  margin:0;
  padding:20px;
}
h1,h2 { text-align:center; }

.container {
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:20px;
}

canvas {
  background:#f5ecd8;
  border:3px solid #5a4632;
  cursor:crosshair;
}

button,input,select,textarea {
  background:#3b2f22;
  color:#e8dcc2;
  border:1px solid #6d563c;
  padding:6px;
  margin:4px 0;
}

.rune-list img {
  width:50px;
  background:#f5ecd8;
  border:2px solid #5a4632;
  margin:3px;
}

#pergaminho {
  background:#f3e6c8;
  color:#2b1f12;
  padding:20px;
  font-size:22px;
  border:6px solid #7a5a36;
  min-height:200px;
}
</style>
</head>

<body>
<h1>ðŸœ‚ Forjador de Alfabeto RÃºnico ðŸœ‚</h1>

<div class="container">

<!-- DESENHO -->
<div>
<h2>Desenhar Runa</h2>
<canvas id="draw" width="300" height="300"></canvas><br>
Letra:
<input id="letra" maxlength="1">
<button onclick="salvarRuna()">Salvar Runa</button>
<button onclick="limpar()">Limpar</button>
</div>

<!-- ALFABETO -->
<div>
<h2>Alfabeto Criado</h2>
<div class="rune-list" id="lista"></div>
<button onclick="exportarAlfabeto()">Exportar Alfabeto</button>
</div>

</div>

<hr>

<h2>Mensagem Codificada</h2>
<textarea id="mensagem" rows="4" style="width:100%"></textarea>
<button onclick="gerarPergaminho()">Gerar Pergaminho</button>

<h2>Pergaminho Final</h2>
<div id="pergaminho"></div>
<button onclick="exportarImagem()">Exportar como Imagem</button>

<script>
const canvas = document.getElementById("draw");
const ctx = canvas.getContext("2d");
let desenhando = false;
let alfabeto = {};

canvas.onmousedown = () => desenhando = true;
canvas.onmouseup = () => desenhando = false;
canvas.onmousemove = e => {
  if(!desenhando) return;
  ctx.lineWidth = 3;
  ctx.lineCap = "round";
  ctx.strokeStyle = "#000";
  ctx.lineTo(e.offsetX, e.offsetY);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(e.offsetX, e.offsetY);
};

function limpar(){
  ctx.clearRect(0,0,300,300);
  ctx.beginPath();
}

function salvarRuna(){
  const letra = document.getElementById("letra").value.toUpperCase();
  if(!letra) return alert("Digite uma letra");
  alfabeto[letra] = canvas.toDataURL();
  atualizarLista();
  limpar();
}

function atualizarLista(){
  const div = document.getElementById("lista");
  div.innerHTML="";
  for(let l in alfabeto){
    const img = document.createElement("img");
    img.src = alfabeto[l];
    img.title = l;
    div.appendChild(img);
  }
}

function exportarAlfabeto(){
  const blob = new Blob([JSON.stringify(alfabeto)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "alfabeto_runico.json";
  a.click();
}

function gerarPergaminho(){
  const texto = document.getElementById("mensagem").value.toUpperCase();
  const perg = document.getElementById("pergaminho");
  perg.innerHTML="";
  for(let c of texto){
    if(alfabeto[c]){
      const img = document.createElement("img");
      img.src = alfabeto[c];
      img.style.width="40px";
      img.style.margin="2px";
      perg.appendChild(img);
    } else {
      perg.innerHTML += c===" " ? " " : "?";
    }
  }
}

function exportarImagem(){
  html2canvas(document.getElementById("pergaminho")).then(canvas=>{
    const a = document.createElement("a");
    a.href = canvas.toDataURL();
    a.download = "pergaminho_runico.png";
    a.click();
  });
}
</script>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</body>
</html>
